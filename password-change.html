<!DOCTYPE html>
<html lang="en-US">
<head>

<!-- title and meta -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<meta name="description" content="Website desc. goes here." />
<title>Zingg Music Lab - Change Your Password</title>

<!--[if IE]>
    <script src="js/html5shiv.js"></script>  
    <style type="text/css">
    .clear {
      zoom: 1;
      display: block;
    }
    </style>
<![endif]-->

<script src="js/jquery-1.11.2.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="js/jquery.storageapi.min.js"></script>
<script src="js/superagent.js"></script>
<!--<script async src="js/smoothscroll.js"></script>-->
<script src="js/parsley-config.js"></script>
<script src="js/parsley.min.js"></script>
<script src="js/ractive.min.js"></script>
<script src="js/delorean.min.js"></script>
<script src="js/dispatcher.js"></script>

<!-- css General -->
<link rel="stylesheet" href="css/base3.css">
<link rel="stylesheet" href="css/style3.css">
<link rel="stylesheet" href="css/parsley.css">

<!-- js -->
<script>
    $(document).ready(function(){
        $("#nav-mobile").html($("#nav-main").html());
        $("#nav-trigger span").click(function(){
            if ($("nav#nav-mobile ul").hasClass("expanded")) {
                $("nav#nav-mobile ul.expanded").removeClass("expanded").slideUp(250);
                $(this).removeClass("open");
            } else {
                $("nav#nav-mobile ul").addClass("expanded").slideDown(250);
                $(this).addClass("open");
            }
        });
    });
</script>

<script async src="js/modernizr.js"></script>
<script async src="js/tabs.js"></script>
<script async src="js/core.js"></script>

<script>
$(document).ready(function () {

    var activeDiv = 1;
    showDiv(activeDiv);
    var timer = setInterval(changeDiv, 9000);


    function changeDiv() {
        activeDiv++;
        if (activeDiv == 6) {
            activeDiv = 1;
        }
        showDiv(activeDiv);
    }

    function showDiv(num) {
        $('div.display').hide("slow");
        $('#div' + num).fadeToggle("slow");
    }


});

</script>
</head>

<body>
<div id="wrapper">
  <div id="main">
    <!-- Begin Top Bar (Discount Coupon / Buy Ticket)  -->
    <!-- Begin Nav Container -->
    <div class="container">
      <div class="inner_container">
        <div id="nav-trigger">
          <span><img src="img/zingg_logo2.png" width="162" height="31"><br>Menu</span>
        </div>
        <nav id="nav-main">
          <div class="logo">
            <a href="index.html"><img src="img/zingg_logo.png" alt="Zingg Music Lab"></a>
          </div>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="basic.html">ZML Basic</a></li>
            <li><a href="enterprise.html">ZML Enterprise</a></li>
            <li><a href="music.html">The Music</a></li>
            <li><a href="clients.html">Our Clients</a></li>
            <!-- <li><a href="index.htm" class="home">Home</a></li>-->
            <li class="login"><a href="login.html" style="margin-left:20px;">LOGIN</a></li>
          </ul>
        </nav>
        <nav id="nav-mobile">
          <div class="logo">
            <a href="index.html"><img src="img/zingg_logo.png" alt="Zingg Music Lab"></a>
          </div>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="basic.html">ZML Basic</a></li>
            <li><a href="enterprise.html">ZML Enterprise</a></li>
            <li><a href="music.html">The Music</a></li>
            <li><a href="clients.html">Our Clients</a></li>
            <!-- <li><a href="index.htm" class="home">Home</a></li>-->
            <li class="login"><a href="login.html" style="margin-left:20px;">LOGIN</a></li>
          </ul>
        </nav>
      </div>
    </div>
    <!-- End Nav Container -->
    <!-- Begin Main Content Container -->
    <div class="block_1_bg" style="padding-bottom: 50px;">
      <div class="top_offset">
        <div class="block_level_content_holder" id="block-1"></div>
      </div>
    </div>
  </div>
 
<!-- BEGIN Footer -->
<div class="footer">
  <div class="block_level_content_holder">
    <div class="footer_block_first">
      <h3>ZML Basic</h3>
      <p><a href="basic.html">Features</a></p>
      <p><a href="easy_setup.html">Easy Setup</a></p>
      <p><a href="music.html">The Music</a></p>
      <p><a href="signup_1.html">Sign Up / Sign In</a></p>
    </div>
    <div class="footer_block">
      <h3>ZML Enterprise</h3>
      <p><a href="enterprise.html">Features</a></p>
      <p><a href="easy_setup.html">Setup / Tech Specs</a></p>
      <p><a href="music.html">The Music</a></p>
      <p><a href="faqs.html">FAQs</a></p>
      <p><a href="contact.html">Contact Sales</a></p>
    </div>
    <div class="footer_block">
      <h3>Contact The Lab</h3>
      <h4>SALES</h4>
      <p><a href="mailto: musicsales@zinggmusiclab.com">musicsales@zinggmusiclab.com</a></p>
      <h4>CUSTOMER SUPPORT</h4>
      <p><a href="mailto:service@zinggmusiclab.com">service@zinggmusiclab.com</a></p>
      <h4>ONLINE</h4>
      <p> <a href="contact.html">Online Contact Form</a></p>
    </div>
  </div>
</div>
<!-- END Footer -->
 <!-- BEGIN Copyright Box -->
  <div class="copyright_bg">
    <div class="block_level_content_holder">
      © Copyright Zingg Music Lab. All Rights Reserved.
    </div>
  </div>
<!-- END Copyright Box -->
</div>

<!-- main ractive.js template -->
<script id="main-tmpl" type="text/ractive">

<div class="login_padding">
  {{>flash}}
  <div class="signup_fields">
    {{>step1}}
    {{>step2}}
    {{>step3}}
  </div>
</div>

<!-- inline partials -->
<!-- {{>flash}} -->
{{#each stores.flash.store.messages:i}}
  <div id='flash-{{i}}' class='flash flash-{{this.level}}'>{{{html}}}</div>
{{/each}}
<!-- {{/flash}} -->

<!-- {{>step1}} -->
{{#if step == 1 }}
<h2 style="text-align:center; margin-bottom: 15px;">Expired or Invalid Message</h2>
<p>If you were trying to reset your password from a message your were sent, the link you used has expired.<br>
<a href="password-reset.html">Click here</a> to re-send the message, or send
an email to support@zinggmusiclab.com.</p>
{{/if}}
<!-- {{/step1}} -->

<!-- {{>step2}} -->
{{#if step == 2 }}
{{#with stores.auth.store.user_data}}
<h2 style="text-align:center; margin-bottom: 15px;">Change Your Password</h2>
<p>User Name: {{user.username}}<br>
Enter and confirm your new password for Zingg Music Lab. 
An email will be sent with the new password for your records.</p>
<form id="pw-form" on-submit="submitForm">
  <div class="form-title">New Password</div>
  <input class="form-field" type="password"  id='password' name='password' 
    required data-parsley-pattern='^[-_A-Za-z0-9!@$#%^&*()+=~:;,./\\]{5,20}$' />
  <br />
  <div class="form-title">Retype Password</div>
  <input class="form-field" type="password" id='password-confirmation' name='password_confirmation' 
    required data-parsley-equalto='#password' />
  <br />
  <div class="signup_button">
    <button type="submit" id="submit" name="submit">Next »</button>
  </div>
</form>
{{/with}}
{{/if}}
<!-- {{/step2}} -->

<!-- {{>step3}} -->
{{#if step == 3 }}
<h2 style="text-align:center; margin-bottom: 15px;">Your Password Was Changed</h2>
<p>You are now logged in with your new password.<br>
<a href="music.html">Click here</a> to go back to the player.</p>
{{/if}}
<!-- {{/step3}} -->

</script>

<!-- ractive.js view -->
<script>

var ractive = new Ractive({
  el: 'block-1',
  template: '#main-tmpl',
  magic: false,
  parsley_init: false,
  data: {
    stores: {
      auth: authStore,
      flash: flashStore 
    },
    step: 1,
  },
  oninit: function() {
    var _ractive = this;
    setupRactiveStores( _ractive );
    var qs = parseQueryString();
    AuthActions.validateToken( { token: qs['token'], access: 'password' }, null );
    FlashActions.showFlash();
  },
  onchange: function() {
    if ( this.data.step == 1 ) {
      var next_step = this.get( 'stores.auth.store.next_step' );
      if ( next_step == 2 ) {
        this.set( 'step', 2 );
      }
    } else if ( this.data.step == 2 ) {
      var next_step = this.get( 'stores.auth.store.next_step' );
      if ( next_step == 3 ) {
        this.set( 'step', 3 );
      } else if ( !this.parsley_init && $( '#pw-form' ).length > 0 ) {
        var p_form = $( '#pw-form' );
        p_form.parsley();
        this.parsley_init = true;
      }
      var errors = this.get( 'stores.auth.store.form_errors.password' );
      if ( errors ) {
        for (var i=0; i<errors.length; i++) {
          var p_field = $( "input[name='" + errors[i].field + "']" ).parsley();
          var message = 'This value ' + errors[i].error;
          window.ParsleyUI.removeError(p_field, 'validation-error' );
          window.ParsleyUI.addError(p_field, 'validation-error', message );
        }
      }
    }
  },
});

ractive.on( 'submitForm', function( event ) {
  var e = event.original;
  if ( e ) { e.preventDefault; e.stopPropagation; }
  var token = this.get( 'stores.auth.store.user_data.token.value' );
  if ( token ) {
    var p_form = $( '#pw-form' ).parsley();
    if ( p_form.isValid() ) {
      var data = $( '#pw-form' ).serialize();
      AuthActions.changePassword( token, data, null );
    }
  }
  return false;
});

</script>

<script src="js/jquery.modal.js"></script>
<script src="js/site.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54262092-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
